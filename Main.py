import os
import re
############################################################################################
#BLOCK 1 : variables 
#direname = 'IN' # dossier d'entrée
#############################################################################################
dirName= 'IN'
in_path = os.path.join(os.path.dirname(os.path.abspath(__file__)), dirName)
stringFiles= (os.listdir(in_path))
############################################################################################
#recuperation des numéros de factures qui se trouvent dans le nom des fichiers
#exemple de nom de fichier : 
# INVOIC1543693499_PL5263376320_PL5222574715_5430001208054_5906874381007_925073683.pdf
#extraction du code unique de la facture 925073683
liste_trouvee_unique_code= [re.search(r'_(\d+)\.pdf$', f).group(1) for f in stringFiles]

############################################################################################
#todo: recupere les numéros de factures dans un fichier texte dans le dosser IN.
#eviter de toucher le code et rajouter les vergules a la main
##############################################################################################

# Listes de numero unique  sur le excel
liste_initiale = [
925069535,
925071682,
925071791,
925071792,
925071836,
925071842,
925071842,
925071842,
925071843,
925071844,
925071870,
925072122,
925072234,
925072234,
925073682,
925073683,
925073695,
925073695,
925073696,
925073697,
925073697,
925074121,
925074124,
925074129,
925075012,
925075087,
925075097,
925076157,
925076173,
925076174,
925076180,
925076180,
925076181,
925076184,
925076185,
925076185,
925076189,
925076192,
925076193,
925076194,
925076194,
925076195,
925076195,
925076195,
925076196,
925076196,
925076197,
925076198,
925076198,
925076604,
925076605,
925076607,
925076612,
925076745,
925077108,
925077115,
925078819,
925078824,
925078830,
925078831,
925078831,
925078833,
925078833,
925078867,
925078876,
925078876,
925078877,
925078877,
925078963,
925078963,
925078963,
925078964,
925078964,
925079258,
925079268,
925079275,
925079389,
925079389,
925079390,
925079390,
925079392,
925079413,
925080801,
925080801,
925082216,
925083204,
925083204,
925083207,
925083207,
925083211,
925083212,
925083213,
925083214,
925083223,
925083223,
925083224,
925083224,
925083225,
925083226,
925083227,
925083227,
925083228,
925083228,
925083229,
925083230,
925083231,
925083231,
925083231,
925083232,
925083234,
925083236,
925083239,
925083239,
925083246,
925083360,
925086041,
925086041,
925086043,
925086043,
925086047,
925086058,
925086058,
925086099,
925086100,
925086100,
925086160,
925086168,
925086168,
925086169,
925086180,
925086180,
925086180,
925086181,
925086181,
925087819,
925087867,
925087869,
925087872,
925087878,
925087879,
925087879,
925087880,
925087880,
925087880,
925087881,
925087881,
925088898,
925088898,
925088910,
925089425,
925089425,
925090506,
925090506,
925090507,
925090508,
925090509,
925090510,
925090511,
925090512,
925090512,
925090513,
925090514,
925090515,
925090516,
925090516,
925090517,
925090517,
925090525,
925090527,
925090528,
925090529,
925090530,
925090531,
925090532,
925090532,
925090533,
925090534,
925090535,
925090535,
925090536,
925090536,
925090537,
925090538,
925090539,
925090539,
925090539,
925090540,
925090540,
925090542,
925090546,
925090646,
925091227,
925091275,
925091276,
925091543,
925091546,
925091546,
925091607,
925091608,
925091608,
925091609,
925093534,
925093537,
925093537,
925093541,
925093541,
925093545,
925093545,
925093551,
925093551,
925093599,
925093599,
925093612,
925093682,
925093682,
925093687,
925093687,
925094027,
925094030,
925094030,
925094085,
925094085,
925094113,
925094114,
925094114,
925095620,
925095666,
925095666,
925095666,
925095696,
925097400,
925098659,
925098659,
925098660,
925098661,
925098662,
925098662,
925098663,
925098664,
925098665,
925098670,
925098671,
925098671,
925098672,
925098672,
925098673,
925098673,
925098674,
925098674,
925098675,
925098676,
925098677,
925098677,
925098678,
925098678,
925098679,
925098680,
925098681,
925098681,
925098681,
925098682,
925098683,
925098684,
925098684,
925098689,
925098690,
925098690,
925099360,
925101825,
925101829,
925101839,
925101848,
925101848,
925101887,
925101887,
925102000,
925102000,
925102016
]



set_initiale = set(liste_initiale)
set_trouve = set(liste_trouvee_unique_code)
factures_manquantes = (set_initiale - set_trouve)
#print("Factures manquantes :",factures_manquantes)
print("################################################################################")
print("total des factures manquantes :",len(factures_manquantes))
print("################################################################################")


